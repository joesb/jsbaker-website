<head>
  <!-- Analytics & Tag Manager -->
  {% if env.isProd %}
    {% include "layouts/components/google-tagmanager.njk" %}
  {% endif %}
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  {% if page.url == '/' %}
  <title>{{ metadata.title }} | {{ pageTitle or title or renderData.title or metadata.title }}</title>
  {% elif layout == "page-library.njk" %}
  <title>Dr B's Library: {{ pageTitle or title or renderData.title or metadata.title }}</title>
  {% else %}
  <title>{{ pageTitle or title or renderData.title or metadata.title }} | {{ metadata.title }}</title>
  {% endif %}

  <!-- meta -->
  <meta name="author" itemprop="author" content="{{ metadata.author.name }}">
  <meta name="description" itemprop="description" content="{{ description }}">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/static/apple-touch-icon.png" type="image/png">
  <link rel="icon" href="/static/favicon/favicon-16x16.png" type="image/png" sizes="16x16">
  <link rel="icon" href="/static/favicon/favicon-32x32.png" type="image/png" sizes="32x32">
  <link rel="manifest" href="/static/favicon/site.webmanifest">

  {# Google Fonts #}
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,wght@0,300;0,500;0,700;1,300;1,500;1,700&family=PT+Serif:ital,wght@0,700;1,700&display=swap" rel="stylesheet">
  
  {# OpenProps #}
  <link rel="stylesheet" href="//unpkg.com/open-props@1.7.13/open-props.min.css" />
  <link rel="stylesheet" href="//unpkg.com/open-props@1.7.13/normalize.light.min.css" />
  <link rel="stylesheet" href="//unpkg.com/open-props@1.7.13/buttons.light.min.css" />
  {% set css %}
    {% include "assets/css/styles.css" %}
  {% endset %}
  <style>{{ css | cssmin | safe }}</style>

  {% if styles %}
      {# External styles first #}
      {% for style in styles.external %}
      <link rel="stylesheet" href="{{ style }}" />
      {% endfor %}
      {# Internal styles second #}
      {% for style in styles.internal %}
        {% set include_style %}assets/css/{{ style }}{% endset %}
        {% set include_css %}
          {% include include_style %}
        {% endset %}
      <style>{{ include_css | cssmin | safe }}</style>
      {% endfor %}
    {% endif %}
  
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  {% set js %}
    {% include "assets/js/inline.js" %}
  {% endset %}
  {% if scripts %}
      {# External scripts first #}
      {% for script in scripts.external %}
      <script src="{{ script }}"></script>
      {% endfor %}
      {# Internal scripts second #}
      {% for script in scripts.internal %}
        {% set include_script %}assets/js/{{ script }}{% endset %}
          {% set include_js %}
            {% include include_script %}
          {% endset %}
    <script>{{ include_js | jsmin | safe }}</script>
      {% endfor %}
    {% endif %}

  {% include "layouts/components/head-social-cards.njk" %}

  <link rel="canonical" href="{% if canonical %}{{ canonical }}{% else %}{{ page.url | url | absoluteUrl(metadata.url) }}{% endif %}" />
</head>